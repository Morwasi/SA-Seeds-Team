<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
        }
        .search-container {
            position: relative;
            margin-bottom: 30px;
            box-shadow: 0 1px 6px rgba(32,33,36,0.28);
            border-radius: 24px;
            max-width: 600px;
            margin: 20px auto;
        }
        .search-box {
            width: calc(100% - 100px);
            padding: 12px 20px;
            border: none;
            border-radius: 24px;
            font-size: 16px;
            outline: none;
        }
        .search-button {
            position: absolute;
            right: 5px;
            top: 5px;
            background: #4285f4;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .weather-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 6px rgba(32,33,36,0.28);
            margin-top: 30px;
            display: none;
        }
        .main-temp {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        .temp-number {
            font-size: 48px;
            font-weight: 400;
        }
        .weather-icon {
            width: 64px;
            height: 64px;
            background: #f8f9fa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .weather-details {
            color: #70757a;
            font-size: 12px;
            margin-bottom: 20px;
        }
        .temperature-graph {
            margin: 20px 0;
            padding: 20px 0;
            border-top: 1px solid #dadce0;
            border-bottom: 1px solid #dadce0;
        }
        .graph {
            height: 150px;
            position: relative;
        }
        .graph-line {
            fill: none;
            stroke: #4285f4;
            stroke-width: 2;
        }
        .graph-area {
            fill: rgba(66, 133, 244, 0.1);
        }
        .graph-point {
            fill: #4285f4;
            r: 3;
        }
        .graph-label {
            font-size: 12px;
            fill: #70757a;
            text-anchor: middle;
        }
        .hour-label {
            font-size: 10px;
            fill: #70757a;
            text-anchor: middle;
        }
        .forecast {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .forecast-day {
            text-align: center;
            flex: 1;
        }
        .day-name {
            color: #70757a;
            font-size: 14px;
            margin-bottom: 8px;
        }
        .day-temp {
            font-size: 16px;
            font-weight: bold;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #70757a;
            display: none;
        }
        .error {
            color: #d93025;
            text-align: center;
            padding: 20px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="search-container">
        <input type="text" id="locationSearch" class="search-box" placeholder="Search for a location">
        <button onclick="searchWeather()" class="search-button">üîç</button>
    </div>

    <div id="loading" class="loading">Loading weather data...</div>
    <div id="error" class="error"></div>

    <div id="weather-container" class="weather-card">
        <div id="location-name" style="font-size: 20px; margin-bottom: 10px;"></div>
        <div id="current-day" style="color: #70757a; margin-bottom: 20px;"></div>
        
        <div class="main-temp">
            <div class="weather-icon">‚òÄÔ∏è</div>
            <div class="temp-number"><span id="current-temp"></span>¬∞C</div>
        </div>

        <div class="weather-details">
            <div id="weather-description"></div>
            <div>Precipitation: <span id="precipitation"></span></div>
            <div>Humidity: <span id="humidity"></span></div>
            <div>Wind: <span id="wind"></span></div>
        </div>

        <div class="temperature-graph">
            <svg id="temp-graph" width="100%" height="150" preserveAspectRatio="none"></svg>
        </div>

        <div id="forecast" class="forecast"></div>
    </div>

    <script>
        const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

        async function searchWeather() {
            const location = document.getElementById('locationSearch').value.trim();
            if (!location) return;

            document.getElementById('loading').style.display = 'block';
            document.getElementById('weather-container').style.display = 'none';
            document.getElementById('error').style.display = 'none';

            try {
                // Get current weather
                const response = await fetch(`https://api.tomorrow.io/v4/weather/realtime?location=${location}&apikey=xEqumIcghTsJZR23DXvHOFIpNmPJBPWs`);
                const weatherData = await response.json();

                // Get forecast
                const forecastResponse = await fetch(`https://api.tomorrow.io/v4/weather/forecast?location=${location}&apikey=xEqumIcghTsJZR23DXvHOFIpNmPJBPWs`);
                const forecastData = await forecastResponse.json();

                displayWeather(weatherData, forecastData, location);
            } catch (error) {
                document.getElementById('error').textContent = 'Error fetching weather data. Please try again.';
                document.getElementById('error').style.display = 'block';
                document.getElementById('loading').style.display = 'none';
            }
        }

        function displayWeather(weatherData, forecastData, location) {
            const weather = weatherData.data.values;
            const forecast = forecastData.timelines.daily;

            // Update current weather
            document.getElementById('location-name').textContent = location;
            document.getElementById('current-day').textContent = new Date().toLocaleDateString('en-US', { weekday: 'long' });
            document.getElementById('current-temp').textContent = Math.round(weather.temperature);
            document.getElementById('precipitation').textContent = `${weather.precipitationProbability}%`;
            document.getElementById('humidity').textContent = `${weather.humidity}%`;
            document.getElementById('wind').textContent = `${weather.windSpeed} km/h`;

            // Update forecast
            const forecastContainer = document.getElementById('forecast');
            forecastContainer.innerHTML = '';
            
            forecast.slice(0, 7).forEach((day, index) => {
                const date = new Date(day.time);
                const dayDiv = document.createElement('div');
                dayDiv.className = 'forecast-day';
                dayDiv.innerHTML = `
                    <div class="day-name">${daysOfWeek[date.getDay()]}</div>
                    <div>‚òÄÔ∏è</div>
                    <div class="day-temp">${Math.round(day.values.temperatureMax)}¬∞</div>
                `;
                forecastContainer.appendChild(dayDiv);
            });

            // Create temperature graph with hourly data
            createGraph(forecast.slice(0, 24));

            document.getElementById('loading').style.display = 'none';
            document.getElementById('weather-container').style.display = 'block';
        }

        function createGraph(hourlyData) {
            const svg = document.getElementById('temp-graph');
            const width = svg.clientWidth;
            const height = svg.clientHeight;
            const padding = 40;

            // Clear previous graph
            svg.innerHTML = '';

            // Get temperature data
            const temps = hourlyData.map(hour => hour.values.temperatureMax);
            const maxTemp = Math.ceil(Math.max(...temps));
            const minTemp = Math.floor(Math.min(...temps));
            const tempRange = maxTemp - minTemp;

            // Create path for the temperature curve
            let pathD = '';
            let areaPathD = '';
            
            temps.forEach((temp, i) => {
                const x = (i * (width - 2 * padding) / (temps.length - 1)) + padding;
                const y = height - (((temp - minTemp) / tempRange) * (height - 2 * padding) + padding);
                
                if (i === 0) {
                    pathD += `M ${x} ${y}`;
                    areaPathD += `M ${x} ${height - padding} L ${x} ${y}`;
                } else {
                    // Use curve command for smooth line
                    const prevX = ((i - 1) * (width - 2 * padding) / (temps.length - 1)) + padding;
                    const cpX = (x + prevX) / 2;
                    pathD += ` C ${cpX} ${y}, ${cpX} ${y}, ${x} ${y}`;
                    areaPathD += ` C ${cpX} ${y}, ${cpX} ${y}, ${x} ${y}`;
                }
            });

            // Complete the area path
            areaPathD += ` L ${width - padding} ${height - padding} L ${padding} ${height - padding} Z`;

            // Create and append the area path
            const areaPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            areaPath.setAttribute('d', areaPathD);
            areaPath.setAttribute('class', 'graph-area');
            svg.appendChild(areaPath);

            // Create and append the line path
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.setAttribute('d', pathD);
            path.setAttribute('class', 'graph-line');
            svg.appendChild(path);

            // Add temperature points and labels
            temps.forEach((temp, i) => {
                const x = (i * (width - 2 * padding) / (temps.length - 1)) + padding;
                const y = height - (((temp - minTemp) / tempRange) * (height - 2 * padding) + padding);

                // Create point
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x);
                circle.setAttribute('cy', y);
                circle.setAttribute('class', 'graph-point');
                svg.appendChild(circle);

                // Add temperature label
                if (i % 3 === 0) {  // Show every third label to prevent overcrowding
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', x);
                    text.setAttribute('y', y - 15);
                    text.setAttribute('class', 'graph-label');
                    text.textContent = `${Math.round(temp)}¬∞`;
                    svg.appendChild(text);

                    // Add hour label
                    const hour = new Date(hourlyData[i].time).getHours();
                    const hourText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    hourText.setAttribute('x', x);
                    hourText.setAttribute('y', height - 10);
                    hourText.setAttribute('class', 'hour-label');
                    hourText.textContent = `${hour}:00`;
                    svg.appendChild(hourText);
                }
            });
        }

        // Allow searching with Enter key
        document.getElementById('locationSearch').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchWeather();
            }
        });
    </script>
</body>
</html>